<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simple Interface for Fitting a Multinomial Topic Model — fit_topic_model • fastTopics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simple Interface for Fitting a Multinomial Topic Model — fit_topic_model" />
<meta property="og:description" content="Fits a multinomial topic model to the count data,
  hiding most of the complexities of model fitting. The default
  optimization settings used here are intended to work well in a wide
  range of data sets, although some fine-tuning may be needed for
  more difficult cases. For full control, use fit_poisson_nmf." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fastTopics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5-15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stephenslab/fastTopics">Source</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simple Interface for Fitting a Multinomial Topic Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/stephenslab/fastTopics/blob/master/R/fit_topic_model.R'><code>R/fit_topic_model.R</code></a></small>
    <div class="hidden name"><code>fit_topic_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a multinomial topic model to the count data,
  hiding most of the complexities of model fitting. The default
  optimization settings used here are intended to work well in a wide
  range of data sets, although some fine-tuning may be needed for
  more difficult cases. For full control, use <code>fit_poisson_nmf</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>fit_topic_model</span>(
  <span class='no'>X</span>,
  <span class='no'>k</span>,
  <span class='kw'>numiter.main</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>numiter.refine</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>method.main</span> <span class='kw'>=</span> <span class='st'>"em"</span>,
  <span class='kw'>method.refine</span> <span class='kw'>=</span> <span class='st'>"scd"</span>,
  <span class='kw'>init.method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"topicscore"</span>, <span class='st'>"random"</span>),
  <span class='kw'>control.init</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>control.main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>numiter</span> <span class='kw'>=</span> <span class='fl'>4</span>),
  <span class='kw'>control.refine</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>numiter</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>extrapolate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>The n x m matrix of counts; all entries of X should be
non-negative. It can be a sparse matrix (class <code>"dgCMatrix"</code>)
or dense matrix (class <code>"matrix"</code>).</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>The number of topics. Must be 2 or greater.</p></td>
    </tr>
    <tr>
      <th>numiter.main</th>
      <td><p>Number of updates of the factors and loadings
to perform in the main model fitting step. Should be 1 or more.</p></td>
    </tr>
    <tr>
      <th>numiter.refine</th>
      <td><p>Number of updates of the factors and loadings
to perform in the model refinement step.</p></td>
    </tr>
    <tr>
      <th>method.main</th>
      <td><p>The method to use for updating the factors and
loadings in the main model fitting step. Passed as argument
"method" to <code><a href='fit_poisson_nmf.html'>fit_poisson_nmf</a></code>.</p></td>
    </tr>
    <tr>
      <th>method.refine</th>
      <td><p>The method to use for updating the factors in
evthe model refinement step. Passed as argument "method"
to <code><a href='fit_poisson_nmf.html'>fit_poisson_nmf</a></code>.</p></td>
    </tr>
    <tr>
      <th>init.method</th>
      <td><p>The method used to initialize the factors and
loadings. See <code><a href='fit_poisson_nmf.html'>init_poisson_nmf</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>control.init</th>
      <td><p>A list of parameters controlling the behaviour
of the optimization and Topic SCORE method in the call to
<code>init_poisson_nmf</code>. This is passed as argument "control" to
<code>init_poisson_nmf</code>.</p></td>
    </tr>
    <tr>
      <th>control.main</th>
      <td><p>A list of parameters controlling the behaviour
of the optimization in the main model fitting step. This is passed
as argument "control" to <code>fit_poisson_nmf</code>.</p></td>
    </tr>
    <tr>
      <th>control.refine</th>
      <td><p>A list of parameters controlling the
behaviour of the of the optimization algorithm in the model
refinement step. This is passed as argument "control" to
<code>fit_poisson_nmf</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>When <code>verbose = TRUE</code>, information about the
progress of the model fitting is printed to the console. See
<code><a href='fit_poisson_nmf.html'>fit_poisson_nmf</a></code> for an explanation of the output.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A multinomial topic model fit; see
  <code><a href='poisson2multinom.html'>poisson2multinom</a></code> and <code><a href='fit_poisson_nmf.html'>fit_poisson_nmf</a></code>
  for details. Note that outputted likelihoods and deviances in
  <code>progress</code> are evaluated with respect to the equivalent
  Poisson NMF model.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>With the default settings, the model fitting is
accomplished in four steps: (1) initialize the Poisson NMF model
fit (<code>init_poisson_nmf</code>); (2) perform the main model fitting
step by running 100 EM updates using <code>fit_poisson_nmf</code>; (3)
refine the fit by running 100 extrapolated SCD updates, again using
<code>fit_poisson_nmf</code>; and (4) recover the multinomial topic model
by calling <code>poisson2multinom</code>.</p>
<p>This two-stage fitting approach is based on our findings that the
EM algorithm initially makes rapid progress toward a solution, but
its convergence slows considerably as the iterates approach a
solution. Close to a solution, we have found that other algorithms
make much more rapid progress than EM; in particularly, we founr
that the extrapolated SCD updates usually performed best). For
larger data sets, more updates in the main model fitting and
refinement steps may be needed to obtain a good fit.</p>
<p>For larger data sets, more than 200 updates may be needed to obtain
a good fit.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Dey, K. K., Hsiao, C. J. and Stephens, M. (2017). Visualizing the
structure of RNA-seq expression data using grade of membership
models. <em>PLoS Genetics</em> <b>13</b>, e1006599.</p>
<p>Blei, D. M., Ng, A. Y. and Jordan, M. I. (2003). Latent Dirichlet
allocation. <em>Journal of Machine Learning Research</em> <b>3</b>,
993-1022.</p>
<p>Hofmann, T. (1999). Probabilistic latent semantic indexing. In
<em>Proceedings of the 22nd International ACM SIGIR Conference</em>,
50-57. doi:10.1145/312624.312649</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='fit_poisson_nmf.html'>init_poisson_nmf</a></code>,
  <code><a href='fit_poisson_nmf.html'>fit_poisson_nmf</a></code>,
  <code><a href='poisson2multinom.html'>poisson2multinom</a></code>,
  <code><a href='fit_multinom_model.html'>fit_multinom_model</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>Matrix</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simulate_count_data.html'>simulate_count_data</a></span>(<span class='fl'>80</span>,<span class='fl'>100</span>,<span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>,<span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)$<span class='no'>X</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>fit_topic_model</span>(<span class='no'>X</span>,<span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><div class='output co'>#&gt; Initializing factors using Topic SCORE algorithm.
#&gt; Initializing loadings by running 10 SCD updates.</div><div class='output co'>#&gt; <span class='message'>Using 4 RcppParallel threads.</span></div><div class='output co'>#&gt; <span class='message'>Using 4 RcppParallel threads.</span></div><div class='output co'>#&gt; Fitting rank-3 Poisson NMF to 80 x 100 sparse matrix.
#&gt; Running 100 EM updates, without extrapolation (fastTopics 0.5-15).
#&gt; iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
#&gt;    1 -8.352950339e+03 +7.79318898e+03 1.17e+00 2.6e-01 5.5e-03 0.817 0.950 0.00
#&gt;    2 -8.346344065e+03 +7.77997644e+03 9.51e-01 1.3e-01 5.0e-02 0.817 0.950 0.00
#&gt;    3 -8.341981803e+03 +7.77125191e+03 7.24e-01 1.0e-01 5.5e-02 0.817 0.950 0.00
#&gt;    4 -8.339012843e+03 +7.76531399e+03 5.97e-01 6.5e-02 4.8e-02 0.817 0.950 0.00
#&gt;    5 -8.336914655e+03 +7.76111762e+03 6.15e-01 4.5e-02 4.6e-02 0.817 0.950 0.00
#&gt;    6 -8.335379223e+03 +7.75804675e+03 5.95e-01 3.8e-02 4.7e-02 0.817 0.950 0.00
#&gt;    7 -8.334222177e+03 +7.75573266e+03 5.52e-01 3.1e-02 4.4e-02 0.817 0.950 0.00
#&gt;    8 -8.333326953e+03 +7.75394221e+03 5.03e-01 2.6e-02 3.9e-02 0.817 0.950 0.00
#&gt;    9 -8.332620114e+03 +7.75252854e+03 4.37e-01 2.2e-02 3.4e-02 0.817 0.950 0.00
#&gt;   10 -8.332058677e+03 +7.75140566e+03 3.60e-01 1.9e-02 2.8e-02 0.813 0.950 0.00
#&gt;   11 -8.331616745e+03 +7.75052180e+03 2.82e-01 1.7e-02 2.3e-02 0.813 0.950 0.00
#&gt;   12 -8.331273356e+03 +7.74983502e+03 2.24e-01 1.5e-02 1.9e-02 0.813 0.950 0.00
#&gt;   13 -8.331007681e+03 +7.74930367e+03 1.82e-01 1.3e-02 1.5e-02 0.817 0.950 0.00
#&gt;   14 -8.330800133e+03 +7.74888857e+03 1.69e-01 1.1e-02 1.2e-02 0.817 0.950 0.00
#&gt;   15 -8.330633728e+03 +7.74855576e+03 1.56e-01 9.0e-03 9.3e-03 0.813 0.950 0.00
#&gt;   16 -8.330489827e+03 +7.74826796e+03 1.40e-01 8.4e-03 8.5e-03 0.813 0.942 0.00
#&gt;   17 -8.330320819e+03 +7.74792995e+03 1.16e-01 7.7e-03 7.6e-03 0.817 0.942 0.00
#&gt;   18 -8.329948145e+03 +7.74718460e+03 3.04e-01 1.6e-02 6.7e-03 0.817 0.938 0.00
#&gt;   19 -8.329116018e+03 +7.74552034e+03 6.20e-01 5.4e-02 1.2e-02 0.817 0.938 0.00
#&gt;   20 -8.328251422e+03 +7.74379115e+03 4.36e-01 7.7e-02 2.4e-02 0.817 0.938 0.00
#&gt;   21 -8.327821832e+03 +7.74293197e+03 1.81e-01 4.5e-02 1.5e-02 0.817 0.938 0.00
#&gt;   22 -8.327648066e+03 +7.74258444e+03 1.42e-01 1.9e-02 1.2e-02 0.817 0.938 0.00
#&gt;   23 -8.327558958e+03 +7.74240622e+03 1.07e-01 8.5e-03 9.3e-03 0.810 0.938 0.00
#&gt;   24 -8.327498094e+03 +7.74228450e+03 8.10e-02 5.0e-03 7.1e-03 0.813 0.938 0.00
#&gt;   25 -8.327445975e+03 +7.74218026e+03 7.00e-02 4.5e-03 5.3e-03 0.813 0.938 0.00
#&gt;   26 -8.327389041e+03 +7.74206639e+03 6.20e-02 4.5e-03 4.4e-03 0.813 0.933 0.00
#&gt;   27 -8.327308158e+03 +7.74190462e+03 7.94e-02 5.3e-03 3.7e-03 0.813 0.933 0.00
#&gt;   28 -8.327174293e+03 +7.74163689e+03 1.64e-01 1.2e-02 3.5e-03 0.813 0.933 0.00
#&gt;   29 -8.326964786e+03 +7.74121788e+03 2.70e-01 2.4e-02 5.5e-03 0.813 0.929 0.00
#&gt;   30 -8.326702968e+03 +7.74069424e+03 3.21e-01 3.6e-02 9.1e-03 0.813 0.929 0.00
#&gt;   31 -8.326437382e+03 +7.74016307e+03 2.75e-01 4.0e-02 1.1e-02 0.813 0.925 0.00
#&gt;   32 -8.326133424e+03 +7.73955516e+03 2.65e-01 3.5e-02 1.2e-02 0.813 0.925 0.00
#&gt;   33 -8.325677809e+03 +7.73864392e+03 4.03e-01 2.7e-02 1.6e-02 0.817 0.925 0.00
#&gt;   34 -8.325123804e+03 +7.73753591e+03 3.75e-01 3.3e-02 2.7e-02 0.817 0.925 0.00
#&gt;   35 -8.324569047e+03 +7.73642640e+03 3.54e-01 2.9e-02 2.6e-02 0.817 0.925 0.00
#&gt;   36 -8.324016415e+03 +7.73532114e+03 5.54e-01 5.0e-02 1.7e-02 0.820 0.921 0.00
#&gt;   37 -8.323495185e+03 +7.73427868e+03 6.87e-01 7.3e-02 1.0e-02 0.820 0.921 0.00
#&gt;   38 -8.323083144e+03 +7.73345460e+03 6.69e-01 8.3e-02 8.6e-03 0.820 0.921 0.00
#&gt;   39 -8.322816566e+03 +7.73292144e+03 5.38e-01 7.6e-02 8.8e-03 0.827 0.921 0.00
#&gt;   40 -8.322665186e+03 +7.73261868e+03 3.82e-01 5.9e-02 8.2e-03 0.827 0.917 0.00
#&gt;   41 -8.322582141e+03 +7.73245259e+03 2.53e-01 4.1e-02 6.6e-03 0.827 0.917 0.00
#&gt;   42 -8.322534561e+03 +7.73235743e+03 1.62e-01 2.7e-02 4.9e-03 0.827 0.917 0.00
#&gt;   43 -8.322504734e+03 +7.73229777e+03 1.04e-01 1.8e-02 3.9e-03 0.823 0.917 0.00
#&gt;   44 -8.322483811e+03 +7.73225593e+03 6.68e-02 1.2e-02 3.4e-03 0.827 0.917 0.00
#&gt;   45 -8.322467089e+03 +7.73222248e+03 4.38e-02 7.7e-03 2.9e-03 0.827 0.917 0.00
#&gt;   46 -8.322451466e+03 +7.73219124e+03 3.76e-02 5.2e-03 2.6e-03 0.827 0.917 0.00
#&gt;   47 -8.322434075e+03 +7.73215646e+03 3.32e-02 3.6e-03 2.2e-03 0.827 0.912 0.00
#&gt;   48 -8.322411333e+03 +7.73211097e+03 3.27e-02 2.7e-03 2.0e-03 0.827 0.908 0.00
#&gt;   49 -8.322378018e+03 +7.73204434e+03 5.55e-02 4.6e-03 1.7e-03 0.827 0.908 0.00
#&gt;   50 -8.322326246e+03 +7.73194080e+03 9.24e-02 7.8e-03 1.5e-03 0.823 0.904 0.00
#&gt;   51 -8.322244582e+03 +7.73177747e+03 1.49e-01 1.3e-02 2.3e-03 0.823 0.904 0.00
#&gt;   52 -8.322118170e+03 +7.73152465e+03 2.29e-01 2.1e-02 3.9e-03 0.827 0.904 0.00
#&gt;   53 -8.321931464e+03 +7.73115124e+03 3.27e-01 3.1e-02 6.4e-03 0.833 0.904 0.00
#&gt;   54 -8.321674256e+03 +7.73063682e+03 4.22e-01 4.3e-02 9.7e-03 0.833 0.904 0.00
#&gt;   55 -8.321347227e+03 +7.72998276e+03 4.82e-01 5.4e-02 1.3e-02 0.833 0.904 0.00
#&gt;   56 -8.320959575e+03 +7.72920746e+03 4.80e-01 6.0e-02 1.6e-02 0.833 0.904 0.00
#&gt;   57 -8.320522083e+03 +7.72833247e+03 4.22e-01 5.8e-02 1.6e-02 0.833 0.904 0.00
#&gt;   58 -8.320057820e+03 +7.72740395e+03 3.88e-01 4.9e-02 2.1e-02 0.837 0.904 0.00
#&gt;   59 -8.319629901e+03 +7.72654811e+03 2.78e-01 3.8e-02 2.4e-02 0.837 0.904 0.00
#&gt;   60 -8.319310829e+03 +7.72590996e+03 1.71e-01 2.8e-02 1.7e-02 0.837 0.904 0.00
#&gt;   61 -8.319103336e+03 +7.72549498e+03 1.19e-01 2.0e-02 8.3e-03 0.840 0.904 0.00
#&gt;   62 -8.318965715e+03 +7.72521974e+03 1.06e-01 1.4e-02 4.5e-03 0.843 0.900 0.00
#&gt;   63 -8.318864580e+03 +7.72501747e+03 1.26e-01 1.3e-02 3.8e-03 0.843 0.900 0.00
#&gt;   64 -8.318784133e+03 +7.72485657e+03 1.37e-01 1.5e-02 4.4e-03 0.843 0.900 0.00
#&gt;   65 -8.318718811e+03 +7.72472593e+03 1.37e-01 1.6e-02 5.0e-03 0.847 0.900 0.00
#&gt;   66 -8.318666630e+03 +7.72462157e+03 1.27e-01 1.6e-02 5.4e-03 0.847 0.896 0.00
#&gt;   67 -8.318625871e+03 +7.72454005e+03 1.10e-01 1.5e-02 5.3e-03 0.847 0.892 0.00
#&gt;   68 -8.318594248e+03 +7.72447680e+03 9.11e-02 1.3e-02 4.9e-03 0.847 0.892 0.00
#&gt;   69 -8.318569223e+03 +7.72442675e+03 7.85e-02 1.0e-02 4.4e-03 0.847 0.892 0.00
#&gt;   70 -8.318548437e+03 +7.72438518e+03 6.79e-02 8.4e-03 3.8e-03 0.843 0.887 0.00
#&gt;   71 -8.318529887e+03 +7.72434808e+03 5.87e-02 6.7e-03 3.3e-03 0.843 0.883 0.00
#&gt;   72 -8.318511858e+03 +7.72431202e+03 5.10e-02 5.2e-03 2.8e-03 0.843 0.883 0.00
#&gt;   73 -8.318492746e+03 +7.72427380e+03 4.48e-02 4.1e-03 2.4e-03 0.843 0.883 0.00
#&gt;   74 -8.318470844e+03 +7.72422999e+03 3.98e-02 3.3e-03 2.1e-03 0.840 0.883 0.00
#&gt;   75 -8.318444164e+03 +7.72417663e+03 4.20e-02 3.4e-03 2.0e-03 0.840 0.883 0.00
#&gt;   76 -8.318410323e+03 +7.72410895e+03 5.30e-02 4.8e-03 2.1e-03 0.840 0.883 0.00
#&gt;   77 -8.318366569e+03 +7.72402144e+03 7.17e-02 6.6e-03 2.4e-03 0.840 0.883 0.00
#&gt;   78 -8.318309987e+03 +7.72390828e+03 9.29e-02 8.8e-03 2.8e-03 0.840 0.883 0.00
#&gt;   79 -8.318237927e+03 +7.72376416e+03 1.14e-01 1.1e-02 3.3e-03 0.840 0.879 0.00
#&gt;   80 -8.318148563e+03 +7.72358543e+03 1.32e-01 1.3e-02 3.9e-03 0.840 0.875 0.00
#&gt;   81 -8.318041536e+03 +7.72337138e+03 1.42e-01 1.5e-02 4.9e-03 0.840 0.875 0.00
#&gt;   82 -8.317918689e+03 +7.72312568e+03 1.77e-01 1.8e-02 5.7e-03 0.840 0.875 0.00
#&gt;   83 -8.317784614e+03 +7.72285753e+03 2.11e-01 2.2e-02 7.3e-03 0.840 0.875 0.00
#&gt;   84 -8.317646094e+03 +7.72258049e+03 2.30e-01 2.6e-02 8.8e-03 0.840 0.875 0.00
#&gt;   85 -8.317509908e+03 +7.72230812e+03 2.28e-01 2.8e-02 9.6e-03 0.840 0.875 0.00
#&gt;   86 -8.317380504e+03 +7.72204932e+03 2.08e-01 2.7e-02 9.6e-03 0.840 0.875 0.00
#&gt;   87 -8.317259703e+03 +7.72180771e+03 1.79e-01 2.5e-02 8.9e-03 0.840 0.875 0.00
#&gt;   88 -8.317148164e+03 +7.72158463e+03 1.49e-01 2.2e-02 7.7e-03 0.840 0.875 0.00
#&gt;   89 -8.317046540e+03 +7.72138139e+03 1.38e-01 1.8e-02 6.4e-03 0.840 0.875 0.00
#&gt;   90 -8.316955353e+03 +7.72119901e+03 1.29e-01 1.6e-02 5.2e-03 0.840 0.875 0.00
#&gt;   91 -8.316874306e+03 +7.72103692e+03 1.14e-01 1.5e-02 4.9e-03 0.840 0.875 0.00
#&gt;   92 -8.316801906e+03 +7.72089212e+03 9.47e-02 1.3e-02 4.6e-03 0.840 0.875 0.00
#&gt;   93 -8.316735517e+03 +7.72075934e+03 7.56e-02 1.0e-02 4.3e-03 0.840 0.875 0.00
#&gt;   94 -8.316671570e+03 +7.72063145e+03 6.92e-02 8.6e-03 4.0e-03 0.840 0.875 0.00
#&gt;   95 -8.316605849e+03 +7.72050000e+03 7.12e-02 7.9e-03 3.8e-03 0.840 0.875 0.00
#&gt;   96 -8.316533991e+03 +7.72035629e+03 8.99e-02 8.1e-03 4.0e-03 0.840 0.875 0.00
#&gt;   97 -8.316452511e+03 +7.72019333e+03 1.24e-01 1.2e-02 4.3e-03 0.840 0.875 0.00
#&gt;   98 -8.316360347e+03 +7.72000900e+03 1.59e-01 1.6e-02 4.5e-03 0.840 0.875 0.00
#&gt;   99 -8.316260155e+03 +7.71980862e+03 1.88e-01 2.0e-02 4.8e-03 0.840 0.875 0.00
#&gt;  100 -8.316157842e+03 +7.71960399e+03 2.02e-01 2.3e-02 5.3e-03 0.840 0.871 0.00
#&gt; Refining model fit.</div><div class='output co'>#&gt; <span class='message'>Using 4 RcppParallel threads.</span></div><div class='output co'>#&gt; Fitting rank-3 Poisson NMF to 80 x 100 sparse matrix.
#&gt; Running 100 SCD updates, with extrapolation (fastTopics 0.5-15).
#&gt; iter   log-likelihood        deviance res(KKT)  |F-F'|  |L-L'| nz(F) nz(L) beta
#&gt;  101 -8.315372029e+03 +7.71803236e+03 7.95e-01 1.4e-01 2.2e-02 0.853 0.858 0.55
#&gt;  102 -8.313630585e+03 +7.71454948e+03 4.04e-01 1.8e-01 1.9e-01 0.870 0.850 0.61
#&gt;  103 -8.312888140e+03 +7.71306459e+03 4.63e+00 1.0e-01 1.7e-01 0.867 0.833 0.67
#&gt;  104 -8.312716137e+03 +7.71272058e+03 1.25e+00 1.2e-01 1.3e-01 0.880 0.825 0.73
#&gt;  105 -8.312716137e+03 +7.71272058e+03 1.25e+00 4.4e-16 4.4e-16 0.880 0.825 0.55
#&gt;  106 -8.312341271e+03 +7.71197085e+03 1.78e-01 3.1e-02 4.3e-02 0.883 0.829 0.60
#&gt;  107 -8.312257367e+03 +7.71180304e+03 7.52e-01 4.5e-02 4.3e-02 0.880 0.829 0.66
#&gt;  108 -8.312220738e+03 +7.71172978e+03 2.21e-01 9.0e-02 7.3e-02 0.880 0.833 0.73
#&gt;  109 -8.312023050e+03 +7.71133441e+03 4.37e-01 1.8e-01 1.6e-01 0.880 0.829 0.80
#&gt;  110 -8.312023050e+03 +7.71133441e+03 4.37e-01 2.2e-16 4.4e-16 0.880 0.829 0.60
#&gt;  111 -8.311941766e+03 +7.71117184e+03 2.19e+00 2.7e-02 4.6e-02 0.873 0.817 0.66
#&gt;  112 -8.311857937e+03 +7.71100418e+03 1.39e-01 2.3e-02 4.5e-02 0.873 0.825 0.73
#&gt;  113 -8.311857937e+03 +7.71100418e+03 1.39e-01 2.2e-16 4.4e-16 0.873 0.825 0.55
#&gt;  114 -8.311815726e+03 +7.71091976e+03 7.39e-02 1.2e-02 2.1e-02 0.873 0.829 0.60
#&gt;  115 -8.311762402e+03 +7.71081311e+03 1.04e-01 2.9e-02 4.7e-02 0.877 0.829 0.66
#&gt;  116 -8.311613366e+03 +7.71051504e+03 1.33e-01 7.2e-02 9.2e-02 0.873 0.829 0.73
#&gt;  117 -8.311613366e+03 +7.71051504e+03 1.33e-01 2.2e-16 4.4e-16 0.873 0.829 0.55
#&gt;  118 -8.311533277e+03 +7.71035486e+03 1.01e-01 3.7e-02 4.5e-02 0.867 0.829 0.60
#&gt;  119 -8.311518138e+03 +7.71032458e+03 2.02e-01 5.7e-02 3.8e-02 0.863 0.825 0.66
#&gt;  120 -8.311498459e+03 +7.71028522e+03 5.13e-02 6.3e-03 1.3e-02 0.863 0.825 0.00
#&gt;  121 -8.311492558e+03 +7.71027342e+03 2.54e-02 5.4e-03 8.6e-03 0.863 0.825 0.73
#&gt;  122 -8.311492311e+03 +7.71027293e+03 3.47e-02 6.7e-03 1.1e-02 0.863 0.825 0.80
#&gt;  123 -8.311492311e+03 +7.71027293e+03 3.47e-02 2.2e-16 4.4e-16 0.863 0.825 0.60
#&gt;  124 -8.311491249e+03 +7.71027081e+03 1.89e-02 2.7e-03 4.3e-03 0.863 0.825 0.66
#&gt;  125 -8.311490651e+03 +7.71026961e+03 1.56e-02 4.5e-03 7.0e-03 0.863 0.825 0.73
#&gt;  126 -8.311490651e+03 +7.71026961e+03 1.56e-02 2.2e-16 4.4e-16 0.863 0.825 0.54
#&gt;  127 -8.311490444e+03 +7.71026919e+03 8.18e-03 1.3e-03 1.9e-03 0.863 0.825 0.60
#&gt;  128 -8.311490364e+03 +7.71026903e+03 7.21e-03 1.4e-03 2.9e-03 0.863 0.825 0.66
#&gt;  129 -8.311490364e+03 +7.71026903e+03 7.21e-03 0.0e+00 0.0e+00 0.863 0.825 0.49
#&gt;  130 -8.311490314e+03 +7.71026893e+03 5.35e-03 3.5e-04 8.3e-04 0.863 0.825 0.54
#&gt;  131 -8.311490259e+03 +7.71026882e+03 3.80e-03 8.7e-04 1.2e-03 0.863 0.825 0.60
#&gt;  132 -8.311490227e+03 +7.71026876e+03 2.21e-03 1.4e-03 1.4e-03 0.863 0.825 0.66
#&gt;  133 -8.311490227e+03 +7.71026876e+03 2.21e-03 2.2e-16 4.4e-16 0.863 0.825 0.49
#&gt;  134 -8.311490214e+03 +7.71026873e+03 1.50e-03 5.6e-04 4.5e-04 0.863 0.825 0.54
#&gt;  135 -8.311490204e+03 +7.71026871e+03 1.59e-03 6.9e-04 7.7e-04 0.863 0.825 0.60
#&gt;  136 -8.311490202e+03 +7.71026871e+03 1.55e-03 6.6e-04 1.1e-03 0.863 0.825 0.66
#&gt;  137 -8.311490202e+03 +7.71026871e+03 1.55e-03 2.2e-16 4.4e-16 0.863 0.825 0.49
#&gt;  138 -8.311490199e+03 +7.71026870e+03 1.51e-03 1.7e-04 3.7e-04 0.863 0.825 0.54
#&gt;  139 -8.311490195e+03 +7.71026870e+03 8.71e-04 2.3e-04 5.4e-04 0.863 0.825 0.60
#&gt;  140 -8.311490194e+03 +7.71026869e+03 6.87e-04 9.9e-05 7.4e-05 0.863 0.825 0.00
#&gt;  141 -8.311490192e+03 +7.71026869e+03 4.89e-04 1.3e-04 9.3e-05 0.863 0.825 0.66
#&gt;  142 -8.311490191e+03 +7.71026869e+03 2.20e-04 2.3e-04 1.6e-04 0.863 0.825 0.72
#&gt;  143 -8.311490191e+03 +7.71026869e+03 2.20e-04 0.0e+00 0.0e+00 0.863 0.825 0.54
#&gt;  144 -8.311490191e+03 +7.71026869e+03 1.45e-04 9.1e-05 6.4e-05 0.863 0.825 0.59
#&gt;  145 -8.311490191e+03 +7.71026869e+03 1.45e-04 2.2e-16 4.4e-16 0.863 0.825 0.45
#&gt;  146 -8.311490191e+03 +7.71026869e+03 7.19e-05 3.9e-05 3.8e-05 0.863 0.825 0.49
#&gt;  147 -8.311490191e+03 +7.71026869e+03 5.31e-05 3.8e-05 4.4e-05 0.863 0.825 0.54
#&gt;  148 -8.311490191e+03 +7.71026869e+03 5.31e-05 4.4e-16 4.4e-16 0.863 0.825 0.40
#&gt;  149 -8.311490191e+03 +7.71026869e+03 4.67e-05 3.5e-06 7.4e-06 0.863 0.825 0.45
#&gt;  150 -8.311490191e+03 +7.71026869e+03 3.69e-05 4.5e-06 5.9e-06 0.863 0.825 0.49
#&gt;  151 -8.311490191e+03 +7.71026869e+03 3.09e-05 9.1e-06 6.8e-06 0.863 0.825 0.54
#&gt;  152 -8.311490191e+03 +7.71026869e+03 2.46e-05 1.2e-05 7.1e-06 0.863 0.825 0.59
#&gt;  153 -8.311490191e+03 +7.71026869e+03 1.50e-05 1.3e-05 9.7e-06 0.863 0.825 0.65
#&gt;  154 -8.311490191e+03 +7.71026869e+03 1.50e-05 2.2e-16 4.4e-16 0.863 0.825 0.49
#&gt;  155 -8.311490191e+03 +7.71026869e+03 9.75e-06 2.0e-06 3.9e-06 0.863 0.825 0.54
#&gt;  156 -8.311490191e+03 +7.71026869e+03 8.66e-06 2.0e-06 4.7e-06 0.863 0.825 0.59
#&gt;  157 -8.311490191e+03 +7.71026869e+03 8.66e-06 2.2e-16 4.4e-16 0.863 0.825 0.44
#&gt;  158 -8.311490191e+03 +7.71026869e+03 7.11e-06 9.1e-07 9.3e-07 0.863 0.825 0.49
#&gt;  159 -8.311490191e+03 +7.71026869e+03 6.09e-06 1.7e-06 1.2e-06 0.863 0.825 0.54
#&gt;  160 -8.311490191e+03 +7.71026869e+03 4.52e-06 5.7e-07 5.9e-07 0.863 0.825 0.00
#&gt;  161 -8.311490191e+03 +7.71026869e+03 3.43e-06 7.5e-07 7.2e-07 0.863 0.825 0.59
#&gt;  162 -8.311490191e+03 +7.71026869e+03 2.08e-06 1.3e-06 1.2e-06 0.863 0.825 0.65
#&gt;  163 -8.311490191e+03 +7.71026869e+03 1.34e-06 1.8e-06 1.4e-06 0.863 0.825 0.71
#&gt;  164 -8.311490191e+03 +7.71026869e+03 1.34e-06 2.2e-16 4.4e-16 0.863 0.825 0.54
#&gt;  165 -8.311490191e+03 +7.71026869e+03 1.34e-06 4.4e-16 4.4e-16 0.863 0.825 0.59
#&gt;  166 -8.311490191e+03 +7.71026869e+03 1.34e-06 2.2e-16 4.4e-16 0.863 0.825 0.44
#&gt;  167 -8.311490191e+03 +7.71026869e+03 1.34e-06 0.0e+00 0.0e+00 0.863 0.825 0.49
#&gt;  168 -8.311490191e+03 +7.71026869e+03 1.09e-06 3.7e-07 6.6e-07 0.863 0.825 0.53
#&gt;  169 -8.311490191e+03 +7.71026869e+03 6.83e-07 2.1e-07 2.7e-07 0.863 0.825 0.59
#&gt;  170 -8.311490191e+03 +7.71026869e+03 2.74e-07 3.1e-07 3.2e-07 0.863 0.825 0.65
#&gt;  171 -8.311490191e+03 +7.71026869e+03 2.74e-07 4.4e-16 4.4e-16 0.863 0.825 0.49
#&gt;  172 -8.311490191e+03 +7.71026869e+03 2.74e-07 0.0e+00 0.0e+00 0.863 0.825 0.36
#&gt;  173 -8.311490191e+03 +7.71026869e+03 1.97e-07 9.3e-08 5.7e-08 0.863 0.825 0.40
#&gt;  174 -8.311490191e+03 +7.71026869e+03 1.97e-07 2.2e-16 4.4e-16 0.863 0.825 0.30
#&gt;  175 -8.311490191e+03 +7.71026869e+03 1.97e-07 0.0e+00 0.0e+00 0.863 0.825 0.23
#&gt;  176 -8.311490191e+03 +7.71026869e+03 1.97e-07 0.0e+00 0.0e+00 0.863 0.825 0.17
#&gt;  177 -8.311490191e+03 +7.71026869e+03 1.97e-07 0.0e+00 0.0e+00 0.863 0.825 0.13
#&gt;  178 -8.311490191e+03 +7.71026869e+03 1.97e-07 0.0e+00 0.0e+00 0.863 0.825 0.10
#&gt;  179 -8.311490191e+03 +7.71026869e+03 1.97e-07 0.0e+00 0.0e+00 0.863 0.825 0.07
#&gt;  180 -8.311490191e+03 +7.71026869e+03 1.72e-07 1.6e-08 2.9e-08 0.863 0.825 0.00
#&gt;  181 -8.311490191e+03 +7.71026869e+03 1.31e-07 1.4e-08 2.8e-08 0.863 0.825 0.08
#&gt;  182 -8.311490191e+03 +7.71026869e+03 1.31e-07 4.4e-16 4.4e-16 0.863 0.825 0.06
#&gt;  183 -8.311490191e+03 +7.71026869e+03 1.31e-07 2.2e-16 4.4e-16 0.863 0.825 0.06
#&gt;  184 -8.311490191e+03 +7.71026869e+03 1.08e-07 2.4e-08 5.2e-08 0.863 0.825 0.07
#&gt;  185 -8.311490191e+03 +7.71026869e+03 1.08e-07 2.2e-16 4.4e-16 0.863 0.825 0.05
#&gt;  186 -8.311490191e+03 +7.71026869e+03 1.08e-07 4.4e-16 4.4e-16 0.863 0.825 0.04
#&gt;  187 -8.311490191e+03 +7.71026869e+03 1.08e-07 2.2e-16 4.4e-16 0.863 0.825 0.03
#&gt;  188 -8.311490191e+03 +7.71026869e+03 1.08e-07 4.4e-16 4.4e-16 0.863 0.825 0.02
#&gt;  189 -8.311490191e+03 +7.71026869e+03 1.08e-07 2.2e-16 4.4e-16 0.863 0.825 0.02
#&gt;  190 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.01
#&gt;  191 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.01
#&gt;  192 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.01
#&gt;  193 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.01
#&gt;  194 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.01
#&gt;  195 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.00
#&gt;  196 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.00
#&gt;  197 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.00
#&gt;  198 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.00
#&gt;  199 -8.311490191e+03 +7.71026869e+03 1.08e-07 0.0e+00 0.0e+00 0.863 0.825 0.00
#&gt;  200 -8.311490191e+03 +7.71026869e+03 9.61e-08 9.5e-09 2.1e-08 0.863 0.825 0.00</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fit</span>))</div><div class='output co'>#&gt; Model overview:
#&gt;   Number of data rows, n: 80
#&gt;   Number of data cols, m: 100
#&gt;   Rank/number of topics, k: 3
#&gt; Evaluation of Poisson NMF fit (200 updates performed):
#&gt;   Poisson NMF log-likelihood: -8.311490191185e+03
#&gt;   Poisson NMF deviance: +7.710268688898e+03
#&gt;   Max KKT residual: +9.610230e-08</div><div class='output co'>#&gt; <span class='message'>Set show.size.factors = TRUE, show.mixprops = TRUE and/or show.topic.reps = TRUE in print(...) to show more informataion</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Peter Carbonetto, Kevin Luo, Kushal Dey, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


